(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33744,        710]
NotebookOptionsPosition[     32338,        681]
NotebookOutlinePosition[     32765,        698]
CellTagsIndexPosition[     32722,        695]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"XRecords", "=", "  ", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</Users/yyfwuhan/Public/Box \
Sync/2019-AlonLab-PI-data-variations/EstimatedDamage/EstimatedDamage_wt_ws7d0_\
smoothed.csv\>\"", ",", "\"\<CSV\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XPerCell", " ", "=", " ", 
   RowBox[{"SplitBy", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], " ", "/@", " ", 
      "XRecords"}], ",", " ", "First"}], " ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8851988100200768`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"0aa5f79a-65fd-45a3-9468-ff6c7af02712"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MPSRpaper", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.33`"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "1.12`"}], ",", 
     RowBox[{"\[Epsilon]", "\[Rule]", "0.157`"}], ",", 
     RowBox[{"\[Eta]", "\[Rule]", "0.0051`"}], ",", 
     RowBox[{"t0", "\[Rule]", "70.6`"}], ",", 
     RowBox[{"\[Eta]0", "->", "0.36"}], ",", " ", 
     RowBox[{"\[Kappa]", "\[Rule]", " ", "0.29`"}], ",", " ", 
     RowBox[{"Xcrit", "\[Rule]", "50"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPSRlowmuhigha", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.295`"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "1.76`"}], ",", 
     RowBox[{"\[Epsilon]", "\[Rule]", "0.108`"}], ",", 
     RowBox[{"\[Eta]", "\[Rule]", "0.00655`"}], ",", 
     RowBox[{"t0", "\[Rule]", "84.`"}], ",", 
     RowBox[{"\[Eta]0", "->", "0.549"}], ",", " ", 
     RowBox[{"\[Kappa]", "\[Rule]", " ", "0.76`"}], ",", " ", 
     RowBox[{"Xcrit", "\[Rule]", "50"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883369250149193*^9, 3.883369257514545*^9}, {
   3.883372251766007*^9, 3.883372259965129*^9}, {3.883372322435142*^9, 
   3.883372417632217*^9}, {3.883372497928443*^9, 3.883372546150268*^9}, {
   3.883372580621503*^9, 3.8833725827172213`*^9}, {3.8833819683192663`*^9, 
   3.883381980101535*^9}, {3.883467177999473*^9, 3.883467195004181*^9}, {
   3.883467237308421*^9, 3.883467293146594*^9}, {3.883467408255188*^9, 
   3.883467412134254*^9}, {3.883467818011511*^9, 3.883467819411787*^9}, {
   3.883471524260553*^9, 3.8834715267553453`*^9}, {3.885195813678686*^9, 
   3.8851958401619873`*^9}, {3.885195950215412*^9, 3.885196051564818*^9}, {
   3.8851961139709797`*^9, 3.885196121282028*^9}, {3.885196154042197*^9, 
   3.885196221761883*^9}, 3.8851962543192587`*^9, {3.8853711168290043`*^9, 
   3.885371157507015*^9}, {3.8853712388484983`*^9, 3.885371241160335*^9}, {
   3.8853712961834803`*^9, 3.885371302197645*^9}, {3.885375885856209*^9, 
   3.885376002795414*^9}, {3.885376042401574*^9, 3.885376042618761*^9}, {
   3.885393267593705*^9, 3.8853932677770042`*^9}, {3.8853937229427967`*^9, 
   3.885393751894199*^9}, {3.8853937889329*^9, 3.885393791268495*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"aa775ab6-7614-4fe1-a258-6ddfb6f59914"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mpSRModelProcess", "[", 
    RowBox[{
    "eta_", ",", " ", "beta_", ",", "epsilon_", ",", "  ", "a_", ",", " ", 
     "upsilon_", ",", " ", "eta0_", ",", " ", 
     RowBox[{"t0_", ":", "0"}], ",", " ", 
     RowBox[{"xstartVal_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VV", "[", "x_", "]"}], " ", "=", 
      RowBox[{"eta0", "+", 
       RowBox[{"eta", "*", "t"}], "-", "  ", 
       RowBox[{"beta", "*", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"a", "*", "x"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"a", "*", "x"}], "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"a", "*", "upsilon"}], "]"}]}], ")"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"proc", " ", "=", " ", 
      RowBox[{"ItoProcess", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"VV", "[", "x", "]"}], " ", ",", 
          SqrtBox[
           RowBox[{"2", "epsilon"}]], ",", 
          RowBox[{"Exp", "[", "x", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", 
          RowBox[{"Log", "[", "xstartVal", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", "t0"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8833698357627583`*^9, 3.883369841625201*^9}, {
  3.883372171584793*^9, 3.883372171836521*^9}, {3.8833799459016247`*^9, 
  3.883379949455639*^9}, {3.883383990289938*^9, 3.883383993934512*^9}, {
  3.883384373685998*^9, 3.883384470513835*^9}, {3.885196284400598*^9, 
  3.885196285366942*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"713ac911-3175-4f20-9d1a-e800624a758c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModelSimuEventsAbsorp", "[", 
   RowBox[{"procName_", ",", " ", "pars_", ",", " ", "x0_", ",", 
    RowBox[{"{", 
     RowBox[{"age0_", ",", " ", "age1_", ",", " ", "simuStep_"}], "}"}], ",", 
    "conditions_", ",", " ", 
    RowBox[{"Ninst_", ":", "1000"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"condlist", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Internal`RealValuedNumericQ", "@", "conditions"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", ">", "conditions"}], "&"}], "}"}], ",", "conditions"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"res", "=", 
     RowBox[{"RandomFunction", "[", 
      RowBox[{
       RowBox[{"procName", "@@", 
        RowBox[{"Join", "[", 
         RowBox[{"pars", ",", 
          RowBox[{"{", 
           RowBox[{"age0", ",", "x0"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"age0", ",", "age1", ",", "simuStep"}], "}"}], ",", "Ninst"}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"trajectories", "=", 
     RowBox[{"res", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", ";;"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"eventDists", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deathtimeinds", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"#", ",", 
               RowBox[{"_", "?", "cond"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "trajectories"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"censorFlags", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "==", "\"\<NotFound\>\""}], ",", " ", "1", ",", 
              "0"}], "]"}], "&"}], "/@", "deathtimeinds"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SurvDist", "=", 
          RowBox[{"EventData", "[", 
           RowBox[{
            RowBox[{"deathtimeinds", "/.", 
             RowBox[{"{", 
              RowBox[{"\"\<NotFound\>\"", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "trajectories", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ")"}]}], "}"}]}], ",", 
            "censorFlags"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "SurvDist"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"cond", ",", "condlist"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "eventDists"}], "==", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eventDists", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "trajectories"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"eventDists", ",", "trajectories"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.818148980022213*^9, 3.818148988521553*^9}, {
   3.818149125887806*^9, 3.818149126589856*^9}, {3.818149324995349*^9, 
   3.818149333624982*^9}, {3.818149834203287*^9, 3.818149938396336*^9}, {
   3.818150011045162*^9, 3.818150014156837*^9}, {3.818150167822645*^9, 
   3.818150171758191*^9}, {3.8181503509041233`*^9, 3.8181503524813957`*^9}, {
   3.8181503960376673`*^9, 3.818150401359654*^9}, {3.818150484747343*^9, 
   3.818150486417872*^9}, {3.8181507385431147`*^9, 3.8181507429656277`*^9}, {
   3.818150781274724*^9, 3.81815078146661*^9}, {3.818150865304744*^9, 
   3.818150868746213*^9}, {3.818150927959989*^9, 3.8181509324084044`*^9}, {
   3.818151145961076*^9, 3.8181511799913807`*^9}, {3.818151685746874*^9, 
   3.818151688458611*^9}, {3.818151940746286*^9, 3.818151941576191*^9}, {
   3.818152238035431*^9, 3.818152259864397*^9}, 3.818152293181941*^9, {
   3.81815236237171*^9, 3.818152374647327*^9}, {3.8181524543141603`*^9, 
   3.818152591620719*^9}, {3.818152678452793*^9, 3.818152792469617*^9}, 
   3.8181528296009073`*^9, {3.818152903599165*^9, 3.8181529078996*^9}, {
   3.818153870891633*^9, 3.818153885554441*^9}, {3.818154066845429*^9, 
   3.818154085641768*^9}, {3.8181544065061893`*^9, 3.8181544448563013`*^9}, {
   3.818154588283346*^9, 3.818154599436316*^9}, {3.818154911323316*^9, 
   3.81815491380578*^9}, {3.818154979579071*^9, 3.818155030750939*^9}, 
   3.818155266984613*^9, {3.81815529806402*^9, 3.818155325405602*^9}, {
   3.8181554369084044`*^9, 3.8181554765857286`*^9}, {3.818155541571157*^9, 
   3.8181555421383667`*^9}, {3.818155610526073*^9, 3.818155710778599*^9}, {
   3.8181559263837748`*^9, 3.818155949107338*^9}, {3.818156281206643*^9, 
   3.8181563231927357`*^9}, {3.818156434263035*^9, 3.818156443949417*^9}, {
   3.818156485686831*^9, 3.8181564890872793`*^9}, {3.818156531724556*^9, 
   3.818156558963654*^9}, 3.818157114595776*^9, {3.8181571608716097`*^9, 
   3.8181571696110487`*^9}, {3.818157200029008*^9, 3.81815722907351*^9}, {
   3.8181600361389523`*^9, 3.8181600878713284`*^9}, {3.8181601930280123`*^9, 
   3.8181602354031076`*^9}, {3.8181602678810797`*^9, 
   3.8181603191513977`*^9}, {3.8181619558269587`*^9, 3.818162025880662*^9}, {
   3.818162085577293*^9, 3.818162155981308*^9}, {3.818222472196369*^9, 
   3.818222476235519*^9}, {3.818223621910404*^9, 3.818223622276009*^9}, {
   3.820051055465376*^9, 3.8200510887732058`*^9}, {3.820053972277796*^9, 
   3.820054036112829*^9}, {3.8200541095476*^9, 3.820054115737586*^9}, {
   3.820054149612358*^9, 3.820054183982202*^9}, {3.820054235911881*^9, 
   3.820054272574149*^9}, {3.820054314839142*^9, 3.82005433472398*^9}, {
   3.820054398289508*^9, 3.8200544940545483`*^9}, {3.820054554790406*^9, 
   3.820054556092643*^9}, {3.820056987031705*^9, 3.8200569879267406`*^9}, {
   3.820057949562331*^9, 3.8200579496945353`*^9}, {3.82006077444377*^9, 
   3.820060799477222*^9}, {3.820221866983911*^9, 3.820221867134905*^9}, 
   3.8202388103876553`*^9, {3.820240099775506*^9, 3.8202401003408213`*^9}, {
   3.820240942716495*^9, 3.820241089633318*^9}, {3.8202411591306334`*^9, 
   3.820241203132255*^9}, {3.820241320927318*^9, 3.820241324676704*^9}, {
   3.820241369020646*^9, 3.820241369835493*^9}, {3.82024145818792*^9, 
   3.820241468867544*^9}, {3.820241572374344*^9, 3.820241608133602*^9}, {
   3.820593910250309*^9, 3.820593939878647*^9}, {3.820595742091392*^9, 
   3.820595743400649*^9}, 3.8205962324062777`*^9, {3.820597018618033*^9, 
   3.8205970248481092`*^9}, {3.820597967586533*^9, 3.8205980068945417`*^9}, {
   3.82059824715211*^9, 3.820598253471838*^9}, {3.820598332629571*^9, 
   3.820598367172265*^9}, {3.8206614979834414`*^9, 3.8206614987224827`*^9}, {
   3.825328193986828*^9, 3.82532819451091*^9}, {3.856925325926116*^9, 
   3.856925327741755*^9}, {3.857025587889998*^9, 3.857025588079899*^9}, {
   3.857026214039997*^9, 3.857026214855748*^9}, {3.8570262513269*^9, 
   3.857026253525799*^9}, {3.857026283863227*^9, 3.857026292493338*^9}, {
   3.8570263535658083`*^9, 3.857026353747353*^9}, {3.8570265628415747`*^9, 
   3.857026563109324*^9}, {3.863494606751575*^9, 3.863494607428957*^9}, {
   3.86350550363691*^9, 3.863505505609458*^9}, {3.86359189403083*^9, 
   3.86359189458051*^9}, {3.8833726339821*^9, 3.883372635244486*^9}, {
   3.883374650566801*^9, 3.883374710979797*^9}, {3.883374757699827*^9, 
   3.883374762322262*^9}, {3.8837179295610647`*^9, 3.883717931834345*^9}, {
   3.883718154620532*^9, 3.883718250262683*^9}, {3.8837183761956863`*^9, 
   3.883718379146954*^9}, {3.883718413825753*^9, 3.8837184226338787`*^9}, {
   3.8837184783289022`*^9, 3.883718478559854*^9}, {3.883718524359406*^9, 
   3.883718531878806*^9}, {3.8837185967238607`*^9, 3.883718742944236*^9}, {
   3.8837188533753157`*^9, 3.883718869156858*^9}, {3.88371895817883*^9, 
   3.883718965185849*^9}, {3.883719014296471*^9, 3.883719134157447*^9}, {
   3.883719226931945*^9, 3.883719319074259*^9}, {3.8837237350756693`*^9, 
   3.883723740692955*^9}, {3.883725378084207*^9, 3.883725385165873*^9}, {
   3.883729919209475*^9, 3.883729926912795*^9}, {3.883962429493318*^9, 
   3.883962440936318*^9}, {3.883962477976886*^9, 3.883962542222224*^9}, {
   3.8839625733983088`*^9, 3.883962579085264*^9}, {3.8839660471741257`*^9, 
   3.883966090474753*^9}, {3.883966120842334*^9, 3.883966175568898*^9}, {
   3.883968855511883*^9, 3.883968857795927*^9}, {3.884061226739225*^9, 
   3.884061227441966*^9}, {3.884061510481687*^9, 3.8840615106590223`*^9}, {
   3.884061547440319*^9, 3.8840615479284782`*^9}, {3.885198391018297*^9, 
   3.885198391790032*^9}, {3.8851984404877157`*^9, 3.885198483931484*^9}, {
   3.885268335456155*^9, 3.8852683433339043`*^9}, {3.885268449541247*^9, 
   3.885268467661336*^9}, {3.885268590191053*^9, 3.885268596166947*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"394cf54c-74fa-4cc6-908d-f09363be7d38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "BASEDIR", "=", 
   "\"\</Users/yyfwuhan/Public/Box \
Sync/2019-AlonLab-PI-data-variations/Figure 4 simulations\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MODEL", "=", "mpSRModelProcess"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ORIGPAR", "=", "MPSRpaper"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stepSize", "=", ".25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nsimupercell", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.88338093458566*^9, 3.8833810475831757`*^9}, {
   3.883381175454125*^9, 3.883381224393944*^9}, {3.883381284888049*^9, 
   3.883381285824679*^9}, {3.883381323522263*^9, 3.883381332409903*^9}, {
   3.883381377019017*^9, 3.883381420165052*^9}, {3.883381468749802*^9, 
   3.883381612919932*^9}, {3.883381677178499*^9, 3.883381682365848*^9}, {
   3.883381716287711*^9, 3.883381727205163*^9}, {3.883381759395817*^9, 
   3.883381811130474*^9}, {3.883381925792102*^9, 3.8833819373512077`*^9}, {
   3.883382007101555*^9, 3.883382031484962*^9}, {3.883382175764326*^9, 
   3.883382183296255*^9}, {3.883382327292403*^9, 3.883382327564337*^9}, {
   3.883382476553643*^9, 3.883382501319788*^9}, {3.8833825497794933`*^9, 
   3.883382567297052*^9}, {3.883382879502408*^9, 3.8833828863245573`*^9}, 
   3.883382919032316*^9, {3.8833831158841343`*^9, 3.883383150336484*^9}, {
   3.883383205429956*^9, 3.8833832825636463`*^9}, {3.8833833960182123`*^9, 
   3.883383427781817*^9}, 3.8833834788868093`*^9, {3.883383575036458*^9, 
   3.883383620202796*^9}, 3.883383688959799*^9, {3.883385561810265*^9, 
   3.8833855620331593`*^9}, {3.883386204075521*^9, 3.883386204511819*^9}, {
   3.8833863416468287`*^9, 3.883386342794055*^9}, {3.8833889423926363`*^9, 
   3.883388959097492*^9}, {3.883389021113608*^9, 3.883389030377185*^9}, {
   3.8833893379516077`*^9, 3.883389346207947*^9}, {3.883400291009313*^9, 
   3.883400311250782*^9}, {3.883402560242899*^9, 3.883402595011166*^9}, {
   3.883402634356368*^9, 3.883402673637816*^9}, {3.8834027286157503`*^9, 
   3.883402729415896*^9}, {3.883404106944386*^9, 3.883404191445366*^9}, {
   3.8834043403143673`*^9, 3.883404340425432*^9}, {3.883404414127695*^9, 
   3.8834045094881697`*^9}, {3.883463977520315*^9, 3.883463977733603*^9}, {
   3.883464309892612*^9, 3.883464311019071*^9}, {3.883465951247993*^9, 
   3.8834659595837793`*^9}, {3.88346788049057*^9, 3.883467896750511*^9}, {
   3.883468626526107*^9, 3.883468633054502*^9}, {3.883468704364613*^9, 
   3.883468718940219*^9}, {3.8834687936843147`*^9, 3.883468796523633*^9}, {
   3.883468848184602*^9, 3.883468852272552*^9}, {3.883468888551593*^9, 
   3.88346888925539*^9}, 3.883468942199436*^9, {3.8834690058144073`*^9, 
   3.883469011148258*^9}, {3.883470414701981*^9, 3.8834704704339113`*^9}, {
   3.883470613126851*^9, 3.883470647197452*^9}, {3.883470679772386*^9, 
   3.883470701483943*^9}, {3.8834710078522987`*^9, 3.88347104309865*^9}, {
   3.883471536401595*^9, 3.883471555723544*^9}, {3.8834716105487623`*^9, 
   3.883471612130185*^9}, 3.883471672173839*^9, {3.8834742197697353`*^9, 
   3.883474220391747*^9}, 3.88348502634936*^9, {3.883636951493814*^9, 
   3.883636959653949*^9}, {3.8836370271321287`*^9, 3.883637033531685*^9}, {
   3.883664654897942*^9, 3.8836647101929407`*^9}, {3.883719392280921*^9, 
   3.883719451977865*^9}, 3.8837223003453493`*^9, {3.883723661340457*^9, 
   3.883723675507577*^9}, {3.883723780179113*^9, 3.883723788720254*^9}, {
   3.883963450418489*^9, 3.883963454538004*^9}, {3.883966240310685*^9, 
   3.883966259452063*^9}, {3.88396785896146*^9, 3.88396789712085*^9}, {
   3.884060541742324*^9, 3.884060560847988*^9}, {3.884061503536873*^9, 
   3.884061532289404*^9}, {3.884061572177244*^9, 3.884061614184067*^9}, {
   3.884061670341545*^9, 3.884061670979109*^9}, {3.884064127731185*^9, 
   3.88406412865198*^9}, {3.885196525109336*^9, 3.8851965387889957`*^9}, {
   3.885196578655725*^9, 3.8851965896373587`*^9}, 3.8852788395562067`*^9, 
   3.885292117541059*^9, 3.885376102234146*^9, 3.885393824668975*^9, {
   3.885410803821014*^9, 3.8854108158079777`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"939f411b-086f-4755-9f21-c63e44ca2dad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"par", "=", "ORIGPAR"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSimulations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x0", "=", 
        RowBox[{"cell", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"origParSimulations", "=", "\[IndentingNewLine]", 
        RowBox[{"ModelSimuEventsAbsorp", "[", 
         RowBox[{"MODEL", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Eta]", ",", "\[Beta]", ",", " ", "\[Epsilon]", ",", "a", ",", 
             " ", "\[Kappa]", ",", "\[Eta]0"}], "}"}], "/.", "par"}], ",", 
          " ", "x0", ",", 
          RowBox[{"{", 
           RowBox[{"17.5", ",", " ", "143.5", ",", "stepSize"}], "}"}], ",", 
          "33", ",", "Nsimupercell"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cell", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"cell", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"origParSimulations", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"origParSimulations", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "*", "28"}], "-", "27"}], ")"}], ";;", 
                  RowBox[{"(", 
                   RowBox[{"#", "*", "28"}], ")"}]}]}], "]"}], "]"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Length", "@", 
                 RowBox[{"origParSimulations", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "j"}], "]"}], "]"}]}], ")"}], "/", 
               "28"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "Nsimupercell"}], "}"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"cell", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"Abs", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{"XRecords", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "==", "24.5"}], "&"}]}], 
         "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8840632727403183`*^9, 3.884063286787201*^9}, {
   3.884063649209338*^9, 3.884063657857576*^9}, {3.884063721400519*^9, 
   3.884063885891083*^9}, {3.8840639217546167`*^9, 3.88406392240475*^9}, {
   3.884063953881338*^9, 3.884064029839836*^9}, {3.884064082222938*^9, 
   3.8840641065497923`*^9}, {3.884064186662266*^9, 3.8840641947786922`*^9}, {
   3.884064227465396*^9, 3.884064282624316*^9}, {3.884064432069001*^9, 
   3.8840644322209682`*^9}, {3.884076933642199*^9, 3.8840769340642548`*^9}, 
   3.8840778252167997`*^9, {3.884097980425943*^9, 3.88409799444634*^9}, {
   3.885197242984748*^9, 3.885197276165943*^9}, {3.885197309300242*^9, 
   3.8851973158352957`*^9}, {3.885197374645651*^9, 3.8851973794411097`*^9}, {
   3.885197593659536*^9, 3.885197639936207*^9}, {3.885197676026235*^9, 
   3.8851976776810923`*^9}, {3.885197712040325*^9, 3.885197712623436*^9}, {
   3.885197744407859*^9, 3.885197791885737*^9}, {3.885197838955756*^9, 
   3.885197841667532*^9}, {3.8851983254810743`*^9, 3.8851983258017893`*^9}, {
   3.885198424693466*^9, 3.885198424988061*^9}, {3.885198506138777*^9, 
   3.885198506570092*^9}, {3.8851990628124866`*^9, 3.885199097369742*^9}, {
   3.885201969300704*^9, 3.885202035576559*^9}, {3.8852023009564238`*^9, 
   3.885202373089223*^9}, {3.885202875665999*^9, 3.885202876025016*^9}, {
   3.885203072436833*^9, 3.8852030768760147`*^9}, {3.885203174601487*^9, 
   3.885203175144328*^9}, {3.885266864191595*^9, 3.885266872166402*^9}, {
   3.885279646867087*^9, 3.8852796482776737`*^9}, {3.885303672098572*^9, 
   3.885303672704504*^9}, {3.885371455050459*^9, 3.885371506736043*^9}, {
   3.8853716956216393`*^9, 3.8853716957966747`*^9}, {3.885373061495616*^9, 
   3.885373097165757*^9}, {3.8853731811108522`*^9, 3.885373181930851*^9}, {
   3.885376111280726*^9, 3.885376114561739*^9}, {3.885393844940916*^9, 
   3.885393851084098*^9}, {3.8853938926839943`*^9, 3.885393893818881*^9}, {
   3.885395066930125*^9, 3.885395088160187*^9}, {3.8853951288652554`*^9, 
   3.8853951306086073`*^9}, {3.88539519077177*^9, 3.885395190993157*^9}, {
   3.885395241995145*^9, 3.885395246898349*^9}, {3.885395298444685*^9, 
   3.885395298594369*^9}, {3.885410379652128*^9, 3.8854103801389008`*^9}, 
   3.885410426642373*^9, {3.8854108214915743`*^9, 3.8854108249863997`*^9}, {
   3.8854109584689217`*^9, 3.8854109613478403`*^9}, {3.885411522532572*^9, 
   3.8854115253390913`*^9}, {3.885411809736793*^9, 3.885411810431507*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"6a213836-1086-4f0e-841b-1f4ecfc958ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allSimuRecords", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"events", "=", 
          RowBox[{"allSimulations", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{"trajs", "=", 
          RowBox[{"allSimulations", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"List", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"allSimulations", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "<>", "\"\<_\>\"", 
                    "<>", 
                    RowBox[{"ToString", "[", "j", "]"}]}], ",", 
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"events", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "j"}], "]"}], "]"}], "/", 
                    "28"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"17.5", "+", "#"}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"events", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "j"}], "]"}], "]"}], "/", 
                    "28"}], "]"}], "]"}]}], ",", " ", 
                 RowBox[{"trajs", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", " ", 
                    RowBox[{";;", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"events", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "j"}], "]"}], "]"}], "/", 
                    "28"}], "]"}]}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "Nsimupercell"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "@", "allSimulations"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885270794224613*^9, 3.885270799368475*^9}, {
   3.885270831615141*^9, 3.8852708536784983`*^9}, {3.8852708847341347`*^9, 
   3.8852708936889057`*^9}, {3.885271244936811*^9, 3.885271245500745*^9}, {
   3.885271428353088*^9, 3.885271513688169*^9}, {3.88527156579631*^9, 
   3.885271609618979*^9}, {3.885271936077162*^9, 3.8852719479778967`*^9}, {
   3.885280102167219*^9, 3.885280108942083*^9}, {3.8852803617122927`*^9, 
   3.885280395082814*^9}, {3.8852804557483273`*^9, 3.885280469386464*^9}, {
   3.885280695776107*^9, 3.8852807061760607`*^9}, {3.8852807943832903`*^9, 
   3.885280819626648*^9}, {3.885371791192937*^9, 3.8853717936892242`*^9}, 
   3.885410829186842*^9, {3.8854118180145283`*^9, 3.885411818485936*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"1fc5259e-3188-408e-a000-ba37161de0ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"BASEDIR", "<>", "\"\</MPSRsurvival_simu.csv\>\""}], ",", 
   "allSimuRecords"}], "]"}]], "Input",
 CellChangeTimes->{{3.885272968019153*^9, 3.885273017116596*^9}, 
   3.8853717830729437`*^9, 3.885376141424568*^9, {3.8854101679906063`*^9, 
   3.885410168181903*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e09845f3-beb0-4a4e-a2d8-0e72e052b132"],

Cell[BoxData["\<\"/Users/yyfwuhan/Public/Box \
Sync/2019-AlonLab-PI-data-variations/Figure 4 \
simulations/MPSRsurvival_simu.csv\"\>"], "Output",
 CellChangeTimes->{
  3.885376357020488*^9, 3.885394136600787*^9, {3.885410169179994*^9, 
   3.885410179703927*^9}, 3.8854108395681753`*^9, 3.885411260557783*^9, 
   3.885411758100329*^9, 3.885412032214117*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"9231df51-bb7b-44b1-8618-4a277715ff6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"allEventIndeces", "=", 
   RowBox[{"0.25", "*", 
    RowBox[{"Join", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"allSimulations", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "allSimulations"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allEventTypes", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"allSimulations", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "allSimulations"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allNames", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"allSimulations", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "@", "j"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "Nsimupercell"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "allSimulations"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSurvivals", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<name\>\"", "->", 
         RowBox[{"allNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<Lifespan\>\"", "->", 
         RowBox[{"allEventIndeces", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<Censorship\>\"", "->", 
         RowBox[{"allEventTypes", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "|>"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "allEventIndeces"}]}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"BASEDIR", "<>", "\"\</MPSRsurvival_simu_survivals.csv\>\""}], ",",
    "allSurvivals"}], "]"}]}], "Input",
 CellChangeTimes->{{3.885372280794984*^9, 3.8853722822375183`*^9}, {
   3.885372342843309*^9, 3.885372380392428*^9}, {3.8853725326772842`*^9, 
   3.8853725423235407`*^9}, {3.8853725968284082`*^9, 3.885372604625861*^9}, {
   3.885372705975124*^9, 3.885372866354609*^9}, {3.885372962386055*^9, 
   3.8853729727596493`*^9}, {3.885373639350533*^9, 3.885373667252589*^9}, {
   3.885373754219928*^9, 3.885373846208889*^9}, {3.885373896527582*^9, 
   3.885373931766073*^9}, {3.885373968038536*^9, 3.885373994006213*^9}, {
   3.885374052892959*^9, 3.885374064042798*^9}, 3.885376380253252*^9, {
   3.885410196550194*^9, 3.885410196717147*^9}, {3.885410847976782*^9, 
   3.88541084828899*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"c4103ec1-1f75-4d73-83ee-cddf7453060a"],

Cell[BoxData["\<\"/Users/yyfwuhan/Public/Box \
Sync/2019-AlonLab-PI-data-variations/Figure 4 \
simulations/MPSRsurvival_simu_survivals.csv\"\>"], "Output",
 CellChangeTimes->{3.8854101972180223`*^9, 3.885410849976973*^9, 
  3.885411260902484*^9, 3.885411758409355*^9, 3.885412032313106*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"1258a189-491c-46ef-8e40-f0efbfd1b3b1"]
}, Open  ]]
},
WindowSize->{1356, 809},
WindowMargins->{{Automatic, -14}, {-134, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0617d0b9-2ec1-4ce1-875a-45a28721d8eb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1286, 35, 142, "Input",ExpressionUUID->"0aa5f79a-65fd-45a3-9468-ff6c7af02712"],
Cell[1847, 57, 2309, 42, 64, "Input",ExpressionUUID->"aa775ab6-7614-4fe1-a258-6ddfb6f59914"],
Cell[4159, 101, 1827, 46, 142, "Input",ExpressionUUID->"713ac911-3175-4f20-9d1a-e800624a758c"],
Cell[5989, 149, 8903, 160, 298, "Input",ExpressionUUID->"394cf54c-74fa-4cc6-908d-f09363be7d38"],
Cell[14895, 311, 4167, 64, 142, "Input",ExpressionUUID->"939f411b-086f-4755-9f21-c63e44ca2dad"],
Cell[19065, 377, 5387, 110, 220, "Input",ExpressionUUID->"6a213836-1086-4f0e-841b-1f4ecfc958ad"],
Cell[24455, 489, 3518, 78, 194, "Input",ExpressionUUID->"1fc5259e-3188-408e-a000-ba37161de0ba"],
Cell[CellGroupData[{
Cell[27998, 571, 406, 8, 37, "Input",ExpressionUUID->"e09845f3-beb0-4a4e-a2d8-0e72e052b132"],
Cell[28407, 581, 435, 7, 42, "Output",ExpressionUUID->"9231df51-bb7b-44b1-8618-4a277715ff6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28879, 593, 3071, 78, 168, "Input",ExpressionUUID->"c4103ec1-1f75-4d73-83ee-cddf7453060a"],
Cell[31953, 673, 369, 5, 87, "Output",ExpressionUUID->"1258a189-491c-46ef-8e40-f0efbfd1b3b1"]
}, Open  ]]
}
]
*)

